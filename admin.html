
<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin - Publică articol</title>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
  <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
  <style>
    body { font-family: sans-serif; padding: 2rem; max-width: 800px; margin: auto; }
    label { font-weight: bold; display: block; margin-top: 1rem; }
    input, select { width: 100%; padding: 0.5rem; }
    #editor { height: 200px; background: white; }
    button { margin-top: 1rem; padding: 0.75rem; background: #0066cc; color: white; border: none; border-radius: 5px; cursor: pointer; }
  </style>
</head>
<body>
  <h1>Publică un articol nou</h1>
  <div id="login-section">
    <button onclick="login()">Autentificare cu Google</button>
  </div>
  <div id="form-section" style="display:none;">
    <label for="titlu">Titlu articol:</label>
    <input type="text" id="titlu" />

    <label for="imagine">Link imagine copertă:</label>
    <input type="text" id="imagine" />

    <label for="etichete">Etichete (ține Ctrl pentru mai multe):</label>
    <select multiple id="etichete">
      <option>depresie</option>
      <option>anxietate</option>
      <option>copii</option>
      <option>cuplu</option>
      <option>psihoterapie</option>
    </select>

    <label for="editor">Conținut articol:</label>
    <div id="editor"></div>

    <button onclick="publica()">Publică articol</button>
  </div>

  <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyDQG6WD-N7ZjtNOC_zf8kMASMYEDujihdM",
      authDomain: "cabinet-psihologic-4666e.firebaseapp.com",
      projectId: "cabinet-psihologic-4666e",
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    const auth = firebase.auth();

    const quill = new Quill('#editor', { theme: 'snow' });

    function login() {
      const provider = new firebase.auth.GoogleAuthProvider();
      auth.signInWithPopup(provider).then(() => {
        document.getElementById('login-section').style.display = 'none';
        document.getElementById('form-section').style.display = 'block';
      }).catch(error => {
        alert("Eroare la autentificare: " + error.message);
      });
    }

    function publica() {
      const titlu = document.getElementById("titlu").value;
      const imagine = document.getElementById("imagine").value;
      const etichete = Array.from(document.getElementById("etichete").selectedOptions).map(opt => opt.value);
      const text = quill.root.innerHTML;

      db.collection("articole").add({
        titlu,
        imagine,
        etichete,
        text,
        timestamp: new Date()
      }).then(() => {
        alert("Articol publicat cu succes!");
        document.getElementById("titlu").value = "";
        document.getElementById("imagine").value = "";
        quill.root.innerHTML = "";
      }).catch(error => {
        alert("Eroare la publicare: " + error.message);
      });
    }
  </script>
</body>
</html>
